<feed xmlns="http://www.w3.org/2005/Atom"><title>dl? cmplnts?</title><subtitle>Zhiming Wang's personal blog</subtitle><link href="http://zmwangx.github.io/atom.xml" rel="self" type="application/atom+xml"/><link href="http://zmwangx.github.io/" rel="alternate" type="text/html"/><updated>2015-12-17T21:28:02-08:00</updated><id>http://zmwangx.github.io/</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><icon>http://zmwangx.github.io/img/icon-400.png</icon><generator uri="https://github.com/zmwangx/zmwangx.github.io">pyblog</generator><entry><title type="html">Spoiled by Retina, in less than a day</title><link href="http://zmwangx.github.io/blog/2015-12-16-spoiled-by-retina-in-less-than-a-day.html"/><updated>2015-12-16T21:10:08-08:00</updated><id>http://zmwangx.github.io/blog/2015-12-16-spoiled-by-retina-in-less-than-a-day.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>I finally got a 15'' Retina MacBook Pro this morning to replace my 13'' mid-2012 non-Retina MacBook Pro, whose spinning disk has been getting increasingly slower (or so I felt).<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-12-16-spoiled-by-retina-in-less-than-a-day.html#fn1" id="fnref1"><sup>1</sup></a> Apparently this is a pretty significant landmark in my personal computing history, since I'm saying goodbye to both spinning disk and non-Retina display on my primary computing device.</p>
<p>The transition was initially smooth except for a few things. First, as a tap-to-click wizard I immediately turned on tap-to-click, but I had a hard time dragging things because it was too easy to trigger a force touch instead on the medium setting, and under the firm setting I could hardly force touch at all; in the end I just turned off force touch altogether, and haven't had any problem since. By the way, I was initially worried about the keyboard too but it worked surprisingly well for me, so no complaints there. Secondly, <a href="http://zmwangx.github.io/blog/2015-08-31-after-all-these-years-10pt-non-anti-aliased-monaco-is-still-the-best.html">10pt non-anti-aliased Monaco</a> looks weird on Retina since it's no longer the beloved bitmap version. I turned on antialiasing and now it's no longer weird, but it felt totally different and I'm not sure if I like it (definitely not as much as the 10pt bitmap Monaco anyway). It's okay right now but I'll probably need to spend some time trying out different fonts. Obviously there are <a href="https://news.ycombinator.com/item?id=10140728">like-minded folks</a> out there. Sad story.</p>
<p>So much for first impressions. Apart from Monaco, everything felt great, until I returned home (I was doing setup away from home to get a less shitty connection) and connected my 27'' external monitor. Holy crap, I couldn't believe my eyes. The dock icons &#8212; the first things I saw before launching anything &#8212; looked <em>so blurry I couldn't stare at them for more than a few seconds</em>. That was after staring at the Retina display for less than five hours. Not to mention PDFs; they look ultra crisp on the Retina display and ultra crappy on non-Retina &#8212; especially in Preview, which is a problem I've been aware of since Yosemite.<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-12-16-spoiled-by-retina-in-less-than-a-day.html#fn2" id="fnref2"><sup>2</sup></a> Moreover, the terminal font is more problematic than initially estimated &#8212; <em>now I have a retina display and a non-retina one side-by-side, yet I can only set one font for my default profile, which will never satisfy both</em>!<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-12-16-spoiled-by-retina-in-less-than-a-day.html#fn3" id="fnref3"><sup>3</sup></a> This is so awkward I can't think of a solution. One obvious approach is to ditch the blurry 27'' and only work from the Retina 15'', but should I really let the large canvas sit idle? No idea. Or should I get a 4K external display? First, a 4K display at 27'' still can't rival the pixel density of 2880x1800 at 15.4'' (Apple ships 5K at 27'' for a reason). Secondly and more importantly, I don't have the budget for such a thing after throwing money at an expensive 15'' rMBP (with 512 GB SSD)...</p>
<p>Transition periods are always awkward, I guess.</p>
<hr/>
<p><strong>12/17/2015 Update.</strong> After more than a full day's use, I actually quite love 10pt Monaco on a Retina display. I tried various fonts, including Menlo, Consolas and so on, but none of them has that whimsical feeling of Monaco. Hopefully the font is stuck now.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>I haven't got the nerve to replace the hard drive myself, since it looks so much more complicated than upgrading the memory.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-12-16-spoiled-by-retina-in-less-than-a-day.html#fnref1">&#8617;&#65038;</a></p></li>
<li id="fn2"><p>PDFs looked so horrible in Preview (and TeXShop, my LaTeX previewer, which only serves a niche) that I often viewed them in browsers (!!), where text at least looks reasonable (on par with slightly blurry text elsewhere). PDF Expert came along and kind of made the situation better for non-Retina.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-12-16-spoiled-by-retina-in-less-than-a-day.html#fnref2">&#8617;&#65038;</a></p></li>
<li id="fn3"><p>Provided that I'll religiously stick to 10pt non-anti-aliased Monaco on non-Retina.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-12-16-spoiled-by-retina-in-less-than-a-day.html#fnref3">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">Safeguarding git repos against accidental rm</title><link href="http://zmwangx.github.io/blog/2015-12-08-safeguarding-git-repos-against-accidental-rm.html"/><updated>2015-12-08T00:17:39-08:00</updated><id>http://zmwangx.github.io/blog/2015-12-08-safeguarding-git-repos-against-accidental-rm.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>Everyone who has spent a sizable portion of their life in terminals has experienced that "oh shit" moment: you realize what you've done immediately after you've hit enter, but it's already too late. And needlessly to say, many of those are associated to accidental <code>rm</code>s.</p>
<p>I just had one of those moments. I was going to delete a subdirectory of <code>~/.config</code>, but hit return prematurely, and the command line ended up being <code>rm -r ~/.config</code>. Imagine the horror one second later. Fortunately I was saved by the read-only objects in <code>.git</code>, which triggered prompts; however, damage was already done, to some extent. I had to reinit the repo and do a hard reset, and a corrupted submodule was in my way (it blocked my attempt of <code>git reset --hard</code>) which I eventually had to completely remove and re-add. In the end everything was recovered (hopefully) and back to normal, but this episode was definitely not great for heart health, which led me to rethink <code>rm</code>.</p>
<p>I've tried several safer <code>rm</code> solutions before. The first and obvious is to alias <code>rm</code> to <code>rm -i</code>, but having to answer dozens of prompts a day (or more) is agonizing and unproductive. I've also tried trashing, but a nonempty trash can makes me sick, so not for me either. I also used <code>safe-rm</code> for a couple of months, but without supplying my own blacklist (I have none to be blacklisted), I've never hit the default blacklist; apparently I'm not stupid enough to mess in system locations, so this won't really help much. Fortunately though, this time I might have found a very good solution for myself.</p>
<p>The idea is to protect all git repos. Git repos<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-12-08-safeguarding-git-repos-against-accidental-rm.html#fn1" id="fnref1"><sup>1</sup></a> are among the most valuable assets of programmers, and they have the nice property of not being completely removable without <code>-f</code> or <code>--force</code> (the work tree of a submodule, where <code>.git</code> is a regular file containing the relative path of the git dir, can be removed without <code>--force</code>, but we don't want to damage submodules anyway, so let's not single them out). It's unlikely that we would intend to remove a repo directory without specifying <code>-f</code> or <code>--force</code>, so let's just reject all such <code>rm</code> calls.</p>
<p>The wrapper is very easy to write. Here's one implementation for Zsh with support for both GNU coreutils and BSD <code>rm</code>.</p>
<div class="sourceCode"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span class="kw">rm</span> <span class="kw">()</span> <span class="kw">{</span>
    <span class="kw">setopt</span> localoptions noshwordsplit noksharrays
    <span class="kw">local</span> <span class="ot">args_backup</span> <span class="ot">force</span> <span class="ot">node</span>
    <span class="kw">set</span> -A args_backup <span class="ot">$@</span>
    <span class="kw">while</span> <span class="kw">:</span>; <span class="kw">do</span>
        <span class="kw">case</span> <span class="ot">$1</span><span class="kw"> in</span>
            --force<span class="kw">|</span>-*f*<span class="kw">)</span> <span class="ot">force=</span>1 <span class="kw">&amp;&amp;</span> <span class="kw">shift;;</span>
            --<span class="kw">)</span> <span class="kw">shift</span> <span class="kw">&amp;&amp;</span> <span class="kw">break;;</span>
            -*<span class="kw">)</span> <span class="kw">shift;;</span>
            *<span class="kw">)</span> <span class="kw">break;;</span>
        <span class="kw">esac</span>
    <span class="kw">done</span>
    <span class="kw">for</span> node; <span class="kw">do</span>
        <span class="co"># -f, --force hasn't been specified &amp;&amp; node is a git repo</span>
       <span class="kw"> [[</span> <span class="ot">-z</span> <span class="ot">$force</span> &amp;&amp; <span class="ot">-e</span> <span class="ot">$node</span>/.git<span class="kw"> ]]</span> <span class="kw">&amp;&amp;</span> <span class="kw">{</span>
            <span class="kw">printf</span> <span class="st">"\e[31m'%s' is a git repo -- won't remove without the -f or --force option\e[0m\n"</span> <span class="ot">$node</span>
            <span class="kw">return</span> 1
        <span class="kw">}</span>
    <span class="kw">done</span>
    <span class="kw">command</span> <span class="kw">rm</span> <span class="ot">$args_backup</span>
<span class="kw">}</span></code></pre></div>
<p>Personally, I stick it into a <a href="https://github.com/zmwangx/prezto/tree/master/modules/rm_guard">Prezto module</a> available from my fork. Hopefully it will serve me well this time round.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>In this article, "repo" stands for the work tree of a repo, unless otherwise noted; the actual repo with git objects is referred to as "git dir".<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-12-08-safeguarding-git-repos-against-accidental-rm.html#fnref1">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">Bash function exporting fiasco</title><link href="http://zmwangx.github.io/blog/2015-11-25-bash-function-exporting-fiasco.html"/><updated>2015-11-25T15:38:13-08:00</updated><id>http://zmwangx.github.io/blog/2015-11-25-bash-function-exporting-fiasco.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>Bash is the only major shell (and the only shell that I know of) that implements function exporting. By now everyone should have heard of this feature, I suppose, after the publicity of Shellshock last year. I was personally introduced to it while writing parallel processing scripts <a href="https://www.gnu.org/software/parallel/parallel_tutorial.html#Transfer-environment-variables-and-functions">with GNU Parallel</a> (long before Shellshock), and it seemed useful and clever at that time. Back then I often wondered why it didn't make its way into Z shell. However, now that I'm much more seasoned in shell scripting, I can see why and how this feature is troubled and of debatable value.</p>
<p>Two problems lie at the heart of function exporting:</p>
<ol style="list-style-type: decimal">
<li>As always, everything clever comes at a cost;</li>
<li>Code execution from untrusted source.</li>
</ol>
<p>Regarding the first problem, the cost of function exporting is to mess with the environment, in a very hackish way. The environment was designed to hold data, not code, and we're not in the utopia of Lisp; but bash forced its way through. Pre-shellshock, exported <code>func</code> was stored as <code>func=() {...</code> in env; post-shellshock, it was first <code>BASH_FUNC_func()=() {...</code> (which didn't entirely fix the issue), and then <code>BASH_FUNC_func%%=() {...</code>.</p>
<p>The second problem doesn't need much explanation &#8212; <em>shellshock it was</em>. It has been extensively documented elsewhere, so I'll just succinctly comment that to load exported functions into a subshell, function definitions have to be retrieved from the environment and executed (again because we're not in the utopia of Lisp<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-11-25-bash-function-exporting-fiasco.html#fn1" id="fnref1"><sup>1</sup></a>), and loading is done passively from the subshell user's point of view, hence the code execution bug(s). The bug(s) has(have) allegedly been fixed, but code execution (presumably with the appropriate safeguards now) still can't be avoided altogether, so just like a sanitized <code>eval</code>, it would still wake you up at night.</p>
<p>Well, if that's all I have to say, I wouldn't have started this post today. The thing that's bugging me is another issue I've found recently that's entirely avoidable, yet upon which we'll probably never see light ever after due to a combination of factors.</p>
<p>It started with <a href="http://stackoverflow.com/q/33819243/19447840">this question on SO</a>. While troubleshooting I quickly noticed that a Bash-emulated <code>sh</code> imports those <code>BASH_FUNC</code>s from the environment:</p>
<pre><code>&gt; bash -c 'func () { echo "exported function loaded"; } &amp;&amp; export -f func &amp;&amp; ln -sf /bin/bash sh &amp;&amp; ./sh -c func'
exported function loaded</code></pre>
<p>It gets worse when the function isn't Bourne shell compatible (e.g., when it uses process substitution):</p>
<pre><code>&gt; bash -c 'func () { cat &lt;(echo hello); } &amp;&amp; export -f func &amp;&amp; ln -sf /bin/bash sh &amp;&amp; ./sh -c func'
cat: &lt;(echo hello): No such file or directory</code></pre>
<p>That's surprising but not scary enough, because if you're not a fool you won't call <code>func</code> in <code>sh</code> anyway. However, if you're unfortunate enough to be dealing with <code>/bin/sh</code> on OS X (bash 3.2 under the hood, modified by Apple or not I'm not sure), then all hell break loose:</p>
<pre><code>&gt; bash -c 'func () { cat &lt;(echo hello); } &amp;&amp; export -f func &amp;&amp; /bin/sh -c :'  # OS X only
/bin/sh: func: line 0: syntax error near unexpected token `('
/bin/sh: func: line 0: `func () {  cat &lt;(echo hello)'
/bin/sh: error importing function definition for `func'</code></pre>
<p>Note that we're actively doing nothing in <code>sh</code>, yet we get all these syntax errors from loading <code>func</code>. This happens to every invocation of <code>sh</code>, and as you might expect, there are no shortage of programs that are either <code>sh</code> scripts (e.g., fasd) or have internal <code>sh</code> calls (e.g., GNU Parallel). A single export of a Bourn shell incompatible function will haunt you through the entire session. Oops.</p>
<p>As I said, I don't know if the displayed error messages are due to Apple's modifications (anyone willing to look at the <a href="https://opensource.apple.com/source/bash/bash-97/">source code</a>?), since a symlink named <code>sh</code> to <code>/bin/bash</code> doesn't print error messages, but instead load the wrong function, which is almost as bad but less annoying to innocent users. At any rate, it's not even worth reporting, either to GNU or Apple, because we're stuck with bash 3.2 for <code>/bin/sh</code> forever (thank you GPLv3), and it takes hell of an exploit like shellshock to get a small update out of Apple's hands. We can install newer shells to <code>/usr/local</code> as much as we'd like to, but <code>/bin/sh</code> is simply the final word for many tasks involving the shell. Yet it's stained by this troubled bash-specific feature, and it's not going anywhere. So sad.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>I'm not commenting on the security of Lisp.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-11-25-bash-function-exporting-fiasco.html#fnref1">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">We need a programming keyboard on iOS</title><link href="http://zmwangx.github.io/blog/2015-11-15-we-need-a-programming-keyboard-on-ios.html"/><updated>2015-11-15T02:17:05-08:00</updated><id>http://zmwangx.github.io/blog/2015-11-15-we-need-a-programming-keyboard-on-ios.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>We do. If you ever tried to say something on GitHub (web) or StackOverflow (web or app) on iOS, you'll probably agree with me. The stock keyboard (or any third party keyboard that I've heard of) is simply awful at this. Typing on iOS software keyboard is unpleasant enough to begin with, but behold:</p>
<ul>
<li>Auto"correct" messes up everything as fast as you can type, which isn't really fast anyway; might as well call it autorot.</li>
<li>The backtick is a click plus a loooong click (on the single quote key) plus another click away. Good luck typing code in Markdown,<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-11-15-we-need-a-programming-keyboard-on-ios.html#fn1" id="fnref1"><sup>1</sup></a> especially if you use GFM fenced code block like all of us do.</li>
<li>Brackets, curly braces, the underscore, the pound, etc. are all three clicks away.</li>
</ul>
<p>The solution is pretty obvious actually. I don't know about smaller phones, but the software keyboard on a landscape iPhone 6 Plus has four rows, which takes up about 40% of vertical screen estate, and it has fourteen keys in the top row. With a little bit of effort it can be made into a five-row, full-sized keyboard (without arrow keys perhaps) without taking up a ridiculous amount of space. Since the horizontal 6 Plus could handle it, any iPad should be able to handle it too; definitely shouldn't be an iPad Pro-only luxury. Turn off autocorrect on top of that, and you get a decent programming (or better put, programmer-oriented) keyboard.</p>
<p>This is merely a rant, but it would awesome if anyone sets out to make one.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>To be fair, typing BBCode is even worse. Unfortunately that's what Ars Technica use, and I've given up on commenting there.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-11-15-we-need-a-programming-keyboard-on-ios.html#fnref1">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">Microsoft drops unlimited OneDrive storage after people use it for unlimited storage</title><link href="http://zmwangx.github.io/blog/2015-11-06-microsoft-drops-unlimited-onedrive-storage-after-people-use-it-for-unlimited-storage.html"/><updated>2015-11-06T10:49:51-08:00</updated><id>http://zmwangx.github.io/blog/2015-11-06-microsoft-drops-unlimited-onedrive-storage-after-people-use-it-for-unlimited-storage.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p><a href="http://arstechnica.com/information-technology/2015/11/microsoft-drops-unlimited-onedrive-storage-after-people-use-it-for-unlimited-storage/">Story on Ars Technica</a>. <a href="https://blog.onedrive.com/onedrive_changes/">Official announcement</a>. I was playing catch up on this week's RSS when this one punched in my face.</p>
<p>I currently have 5 TB of data in OneDrive. I was once worried about lock-in when I eventually have 20 or 100 TB there, but now that they have shown their true colors, the worries are all gone. They are not even offering anything past 1 TB. We have seen this too many times &#8212; shit happens when people actually use unlimited for unlimited. Usually unlimited quickly becomes qualified, but in this case, unlimited simply becomes limited. What irony when one looks back at their announcement from <a href="http://localhost:8000/blog/2014-10-27-onedrive-goes-unlimited.html">a year ago</a>:</p>
<blockquote>
<p>Today, storage limits just became a thing of the past with Office 365.</p>
</blockquote>
<p>Why even promise when they can't keep it for more than a year.</p>
<p>Okay, Microsoft just reclaimed the top spot of my most-hated-companies list, and my <a href="http://zmwangx.github.io/blog/2015-11-06-microsoft-drops-unlimited-onedrive-storage-after-people-use-it-for-unlimited-storage.html">ongoing efforts on making a usable OneDrive CLI</a> have been wasted. I just pushed the final commit and closed all issues. Maybe it's a blessing that I'll no longer need to deal with that slow and glitchy API; I'll see after experimenting with APIs of other cloud storage providers.</p>
<p>Guess my next stop is either Amazon Cloud Drive or S3, probably the former so that I don't need to calculate.<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-11-06-microsoft-drops-unlimited-onedrive-storage-after-people-use-it-for-unlimited-storage.html#fn1" id="fnref1"><sup>1</sup></a> And a quick search yields an actively-maintained CLI client <a href="https://github.com/yadayada/acd_cli">yadavada/acd_cli</a>, so I may not need to roll my own this time (it depends on usability).</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>Yeah I'm a mathematician, but I hate most calculations that involve $$. &#128514;<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-11-06-microsoft-drops-unlimited-onedrive-storage-after-people-use-it-for-unlimited-storage.html#fnref1">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">AT&amp;T to Pure TalkUSA, one month later</title><link href="http://zmwangx.github.io/blog/2015-10-26-att-to-pure-talkusa-one-month-later.html"/><updated>2015-10-26T00:00:30-07:00</updated><id>http://zmwangx.github.io/blog/2015-10-26-att-to-pure-talkusa-one-month-later.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p><strong>TL;DR</strong>: If you have questions about Pure TalkUSA unanswered by the <a href="https://www.puretalkusa.com/cell-phones-sim-cards.php">official FAQ</a>, I have some information for you starting from the section "<a href="http://zmwangx.github.io/blog/2015-10-26-att-to-pure-talkusa-one-month-later.html#migration-experience">migration experience</a>".</p>
<hr/>
<p>I became an AT&amp;T customer days after arriving in the U.S., and stayed one for three years. The service was okay (I'm not a picky customer), but the pricing was ridiculous. I was paying somewhere between $50 and $60 per month for an AT&amp;T Next plan, with unlimited talk and text and a mere 300 MB of data, phone installments <em>not</em> included (which I was paying the full price anyway). That's actually below average; see <a href="https://zmwangx.github.io/blog/2014-11-10-average-phone-plan-in-the-u-dot-s-costs-ten-time-as-much-as-that-in-the-u-dot-k.html">average phone plan in the U.S. costs ten time as much as that in the U.K.</a>. I could save a bit by joining a family plan (or more precisely, "data share plan"), but then I would lose control over my line and account, which have proven to be very annoying when I needed to upgrade, or otherwise be serviced.</p>
<p>The biggest concern was that I didn't really need unlimited talk and text, so I wasn't using what I was paying for. These days we have too many channels of communications, most of them free. My monthly talk usage was usually around a hundred minutes or less, so I was basically paying a few <em>dimes</em> per minute. Which was like being robbed.</p>
<p>Then I heard about <a href="https://www.puretalkusa.com/">Pure TalkUSA</a> &#8212; an AT&amp;T <a href="https://en.wikipedia.org/wiki/Mobile_virtual_network_operator">MVNO</a> &#8212; from one of my friends. Pure Talk offers <a href="https://www.puretalkusa.com/cell-plans.php">cheap limited plans</a><a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-26-att-to-pure-talkusa-one-month-later.html#fn1" id="fnref1"><sup>1</sup></a> that looked appealing to me. It uses AT&amp;T's network, so for me, the only thing I would lose by switching was part of my monthly expenses, to which I wouldn't object. So I switched last month. Now that I've been on Pure Talk's network for a month, I'll try to talk about the good and bad, as well as some migration caveats, since information is sparse on the Internet. Note: I'm not comparing Pure TalkUSA to other AT&amp;T MVNOs, since I know nothing about any of them.</p>
<p><em>Disclaimer before I start: I can't guarantee that information provided here is accurate (I only speak from the experience of a single customer, that is myself, although I'll try not to make unfounded claims), and I didn't consult Pure TalkUSA before publishing this post, so please don't hold me accountable for anything.</em></p>
<h2 id="migration-experience">
Migration experience
</h2>
<p>A few tips about migration from AT&amp;T:</p>
<ul>
<li><p>About unlocking: After allegedly unlocking your AT&amp;T phone, naturally you would want to make sure it is actually unlocked before ordering a Pure Talk SIM. And you'll find a lot of guides when you google "check if iPhone is unlocked". I'll just tell you this: don't trust those guides. iOS is constantly changing, and the only guaranteed check is to plug in your new SIM. To this day my General-&gt;About-&gt;Carrier shows AT&amp;T, although I'm happily using Pure Talk's network.</p></li>
<li><p>Pure Talk ships your SIM card using USPS (they don't have physical stores), which is slow and expensive. However, I got my SIM much earlier than the estimated delivery date. Not sure if it's a coincidence. Probably location-dependent.</p></li>
<li><p>Porting number: You can choose to port your number during activation, whether you're calling or doing it online (filling out a few webforms). Beware that you must not have cancelled your AT&amp;T service at the time of porting. The porting system was actually down for two days (customer support was very polite and kept apologizing although I said it didn't matter), and on the third day I used the webform but got an error in the end due to the wrong AT&amp;T account number (there's an account number associated to each account &#8212; different from the phone number &#8212; that I've never heard of or used, and I had to call AT&amp;T to extract that info). After acquiring the account number, I called Pure again and the porting process finished almost in an instant. I swapped in the new SIM card (the phone has been unlocked) and was able to make calls after a few seconds.</p></li>
<li><p>About AT&amp;T cancellation: Porting the number will automatically cancel your service with AT&amp;T, so you don't need to call them for cancellation.</p>
<p>An anecdote here: I initially feared the usual customer retention bullshit when I tried to cancel my AT&amp;T service through online chat (I didn't know about automatic cancellation at that time), but there was none. Representative was very polite, and I only got a "sorry to see you go" at the end. So kudos to them.</p></li>
</ul>
<h2 id="pros-and-cons">
Pros and cons
</h2>
<p>Here is a short list of pros and cons of Pure Talk compared to AT&amp;T, in my opinion:</p>
<p>Good:</p>
<ul>
<li><p>Cheap. Obviously. I am currently paying $22.90 ($12.95 + $9.95) for 500 minutes and 400 MB of data, and I'm switching to 250 minutes next month, which would make it $19.95. Note that as advertised, there are no taxes and hidden fees. I always hated the before-tax price tags in the U.S. Just tell me how much I need to pay!</p></li>
<li><p>Network quality (both talk and LTE) is good. Switching from AT&amp;T, I didn't notice a difference. I don't know if this is true nationwide (I live in the Bay Area), but they say it's true on their FAQ.</p>
<p>By the way, shortly after activating the service, I got a text message pointing me to download a profile to my phone in order to use LTE. It's titled "PureLTE" by "Giesecke and Devrient AB Nordic", and I verified with customer support that it is legit.</p></li>
<li><p>You may change your plan at any time with a few clicks, and only need to make up for the price difference. Note that downgrading doesn't grant you a refund.</p></li>
<li><p>Customer service (U.S. based) is mostly very polite and helpful (I did encounter a guy who sounded very tired with his job though), and wait time is generally very short.</p>
<p>Tip: For customer support, <em>call 611 from a Pure Talk line</em> (instead of the usual ten digit customer service number listed on their website) to avoid being charged.</p></li>
</ul>
<p>Bad:</p>
<ul>
<li><p>There's no visual voicemail, only old-schooled voicemail which you need to dial a number to listen to, in the order they were received; moreover, dialing and listening to voicemail counts toward your minute balance. I hardly missed that. I never grew accustomed to voicemail anyway; now I have an excuse to forget about it completely.</p></li>
<li><p>All incoming phone calls and text messages count towards your minute balance (I don't know about what's most common in the U.S., but as far as I know this is rarely the case in China &#8212; you usually only pay for active usage, although you do need an active service to receive calls and messages). Calling toll free numbers counts, too, so now you'll be even more angry when you're put on hold for an hour.</p></li>
<li><p>For iPhone users, or Android users who otherwise bring in their own phones: since they don't sell you your iPhone, they also don't offer insurance plans. So be extra careful with your phone! Paying $100 for a replacement (from AT&amp;T's insurance program) is no more.</p></li>
</ul>
<p>That's basically all I want to say. Hope this post helps someone who's researching Pure Talk.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>Pure Talk also offers an unlimited talk &amp; text plan for $24, excluding data. According to <a href="https://www.puretalkusa.com/mobile-unlimited-plan.php">the "unlimited plus plan" page</a>:</p>
<blockquote>
<p>Compare our Unlimited Plus plans to similar unlimited cell phone plans on the market and you'll see the savings you can receive! While others may pad their higher priced plans with "free" international minutes, we're focused on giving you the best rate for unlimited talk and text, plus data used within the United States.</p>
</blockquote>
<p>I honestly don't know which competitions they are referring to here. If it's AT&amp;T, I'll share an anecdote about international roaming: I went back to China, and got a text message from AT&amp;T saying that I could use data for TWENTY DOLLARS PER MEGABYTE. I would have had to pay $200 to visit The Verge once on 4G.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-26-att-to-pure-talkusa-one-month-later.html#fnref1">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">SIP &#8212; For the Greater Good</title><link href="http://zmwangx.github.io/blog/2015-10-14-sip-for-the-greater-good.html"/><updated>2015-10-14T17:07:24-07:00</updated><id>http://zmwangx.github.io/blog/2015-10-14-sip-for-the-greater-good.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>In recent months I wrote a few thousand words lamenting Finder and <a href="https://en.wikipedia.org/wiki/System_Integrity_Protection">SIP</a> on El Capitan. See <a href="http://zmwangx.github.io/blog/2015-07-30-the-sad-state-of-finder-on-el-capitan.html">The sad state of Finder on El Capitan</a> and <a href="http://zmwangx.github.io/blog/2015-10-14-follow-up-the-sad-state-of-finder-on-el-capitan.html">its follow-up</a>.</p>
<p>For the record, I'm not blaming SIP. It does deal a serious blow to people who in-memory patch stock applications (and there's a good discussion about the creativity aspect on <a href="http://atp.fm/episodes/128">ATP episode 128</a>), but the general public &#8212; at least more than 95% of users &#8212; should not be negatively affected, at least not in the short term. And I can understand why SIP protection comes at this time. Macs used to be safe, but in recent years we are seeing real world exploits increasingly more often. History has shown that technically-challenged users simply can't be entrusted with admin accounts, they are too willing to give their passwords to shady software downloaded from shady corners of the web (and sometimes even renowned corners get hacked). But they are given admin accounts anyway (there has to be someone knowing the admin password), so Apple has to come up with ways to protect them. SIP is a pretty good response.</p>
<p>SIP is also good for new tinkerers. When I first started to tinker with the command line, I wasn't aware of package managers and I wasn't messing inside virtual machines, so I would download packages from official websites, then manually compile and install them to my daily system. Some packages didn't respect the <code>/usr/local/bin</code> (and <code>include</code>, <code>lib</code>, <code>libexec</code>, <code>share</code>, etc.) convention and insisted on <code>/usr/bin</code>; some others used funny locations like a standalone subdirectory of <code>/usr/local</code>; and when things don't work (e.g., can't find libraries when building &#8212; at that time I'm not familiar with <code>CFLAGS=-I</code> yet), I would explictly change <code>PREFIX</code> (probably to <code>/usr</code>) and try again. That way, over a period of a few months, I ended up with a genuinely messed up <code>/usr</code>, with all kinds of stuff everywhere. I probably overwrote quite some binaries shipped with the system. The configuration kind of worked but was pretty fragile. In the end I reinstalled the system, and started to (loosely) follow FHS (<a href="http://www.pathname.com/fhs/">Filesystem Hierarchy Standard</a>) and use package managers (first MacPorts, then Homebrew). Good times. If I were to start tinkering today, I would certainly meet some barriers early on, but I would probably also learn the good practices earlier.</p>
<p>SIP is clearly the future, and I don't blame it. I just hope we don't see a vulnerability in the implementation soon.</p>
]]></content></entry><entry><title type="html">Follow-up: The sad state of Finder on El Capitan</title><link href="http://zmwangx.github.io/blog/2015-10-14-follow-up-the-sad-state-of-finder-on-el-capitan.html"/><updated>2015-10-14T12:30:32-07:00</updated><id>http://zmwangx.github.io/blog/2015-10-14-follow-up-the-sad-state-of-finder-on-el-capitan.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p><strong>10/14/2015 update</strong> (updated even before I published the article). Just as I was finishing this post, an update to TotalFinder came. <a href="http://totalfinder.binaryage.com/beta-changes">1.7.8</a>. And holy cow, it fixed automatic column resizing! The fix isn't perfect &#8212; there's actually a visible delay before resizing, but I'm happy again. Long live TotalFinder!</p>
<hr/>
<p>As expected, it's hard to get Finder to work the way I want it to on El Capitan. The unexpected part is that even after disabling the Debugging Restrictions part of SIP (<code>csrutil enable --without debug</code>), XtraFinder and TotalFinder<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-14-follow-up-the-sad-state-of-finder-on-el-capitan.html#fn1" id="fnref1"><sup>1</sup></a> both can't auto resize columns. Seems that a hole they are both utilizing has been closed. Just like <code>QLEnableTextSelection</code> in <code>com.apple.finder</code>, I guess. Apple gives, Apple takes. XtraFinder has additional problems like folder-on-top not working, window config occasionally forgotten, and the long-standing issue of shitty Chrome-style tab implementation (basically stacking a separate layer on top of each window) that shows a visible white divider, so I'm running TotalFinder right now, not sure about whether it would be abandoned completely next year. Anyway, even after running TotalFinder, it's still that damn old stupid Finder, the columns of which I have to manually resize all the time; just a little bit nicer.</p>
<p>So I went out to look for full Finder replacements. I tried everything listed in the <a href="http://discuss.binaryage.com/t/totalfinder-alternatives/4124">TotalFinder alternatives</a> post on TotalFinder forums. None worked for me. Here's a very brief (batch) review.</p>
<ul>
<li><p><a href="http://likemac.ru/english/">Disk Order</a>, <a href="http://mac.eltima.com/file-manager.html">Commander&#160;</a><a href="http://mac.eltima.com/totalfinder-promo.html">One</a>, <a href="http://www.devstorm-apps.com/dc/">DCommander</a>, and <a href="http://crax.soft4u2.com/">CRAX Commander</a>: No column view. All of them are dual-pane though. What's the advantage of being dual-pane? I can't fathom. Easier to copy/cut and paste? What a joke &#8212; how often do you do that to justify having two panes in your face at all times? Might as well spend the time to do a column view. Column view enables fast navigation and provides a full picture of a directory tree, which is one of the two reasons I use Finder (i.e., a file manager), the other being Quick Look. If I just want to stay in a single directory, and painstakingly navigate in and out, I'll just do everything in the terminal, thank you. By the way, Command One and DCommander are suprisingly similar, both appearance-wise and functionality-wise. Not sure if one rips off the other (looks like DCommander is older). Also, why do most of them call themselves commanders? Another thing that I can't fathom.<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-14-follow-up-the-sad-state-of-finder-on-el-capitan.html#fn2" id="fnref2"><sup>2</sup></a></p></li>
<li><p><a href="http://www.binarynights.com/forklift/">ForkLift</a>: Again, dual-pane, and doesn't seem to offer a single-pane mode, but you can drag the pane divider all the way to the right to hide the second one (including the divider). It has a column view, but doesn't seem to offer column auto resizing. Also, it doesn't hide items with the <code>hidden</code> flag, which is kind of insane. Even more shockingly, it offers no option to show file extensions! Tell me again that this is a power user tool. (Yeah, I know its myriad power user features, but I need the basic ones, and I don't see them. More discussions about "features" at the end.)</p></li>
<li><p><a href="http://www.cocoatech.com/pathfinder/">Path Finder</a>. It actually kind of works. It offers column auto resizing, hidden in the view options of the column view (accessible via &#8984;J). Even "<code>open ~</code>" could open in Path Finder, if you let it be the default file manager; that was a nice surprise, and I'm not sure about the mechanism (maybe <a href="https://apple.stackexchange.com/questions/73529/how-to-change-the-default-file-manager-for-osx">this</a>? Doesn't sound right though). However, it has a horrible default appearance, and even after substantial customizations, it still looks kind of crappy. Also, the auto resizing implementation is incomplete, in that it doesn't offer min and max column size settings, so when auto resizing is enabled, many columns look awfully narrow. I'm also suspicious about its tech support. When I was investigating some issues about it on Google, I found some relevant tickets on its <a href="http://support.cocoatech.com/">support site</a>, but <em>none</em> of the tickets have any replies. I didn't bother to look around, but that was definitely a bad impression.</p>
<p>By the way, I mentioned concerns about Path Finder's pricing in the <a href="http://zmwangx.github.io/blog/2015-07-30-the-sad-state-of-finder-on-el-capitan.html">sad state</a> post. At $40 it's definitely not cheap, but judging from the <a href="http://support.cocoatech.com/kb/installation-and-compatibility/path-finder-version-history">release history</a>, it's more like pay-to-upgrade every other year, rather than every year.</p>
<p>Conclusion: not impressed.</p></li>
</ul>
<p>Finally, a few words about "pro features". Many of these file managers offer a huge bundle of pro features, but quite of a few of them are completely useless. Useless features include builtin text editor, hex editor, terminal, archiver and unarchiver, blah blah blah. Why would anyone use those watered-down builtins? I use the right tool, the dedicated tool, for the right job. (To give one example, Commander One includes a command line that you can type commands to execute &#8212; without command or filename completion, naturally; and it also ships with a builtin terminal accessible via &#8963;O. Apart from horrendous typography, the builtin terminal is also barely better than a dumb term, incapable of handling my prompt theme. Meanwhile, iTerm2 is accessible via a system-wide shortcut &#8997;Space to me &#8212; extremely convenient.) Support for other filesystems, including remote filesystems and in-place archive browsing, could be welcome though, although I seldom need them.</p>
<hr/>
<p>P.S. Here are the version numbers, at the time of writing, of the mentioned software packages (apparently, things might change in later versions):</p>
<ul>
<li>TotalFinder 1.7.6 (beta);</li>
<li>XtraFinder 0.25.5;</li>
<li>Disk Order 3.2.5;</li>
<li>Commander One 1.1.1346;</li>
<li>DCommander 2.7.2;</li>
<li>CRAX Commander 1.10.4 (demo);</li>
<li>ForkLift 2.6.6;</li>
<li>Path Finder 7.2.</li>
</ul>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>TotalFinder 1.7.8+ now supports column auto resizing on El Cap. See update at the top.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-14-follow-up-the-sad-state-of-finder-on-el-capitan.html#fnref1">&#8617;&#65038;</a></p></li>
<li id="fn2"><p>If you Google <a href="https://www.google.com/search?q=file+manager+commander">"file manager commander"</a>, you'll find a hell lot of "commanders". Reminds me of C&amp;C... Oh well.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-14-follow-up-the-sad-state-of-finder-on-el-capitan.html#fnref2">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">The importance of dated, detailed release notes</title><link href="http://zmwangx.github.io/blog/2015-10-12-the-importance-of-dated-detailed-release-notes.html"/><updated>2015-10-12T14:29:42-07:00</updated><id>http://zmwangx.github.io/blog/2015-10-12-the-importance-of-dated-detailed-release-notes.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>I can't stress how much I value release notes, especially for closed source, commercial software. None of us want to invest on a piece of abandonware (unless it is ageless, which is quite unlikely for anything with a GUI), or a piece of software that is not completely abandoned, but takes a full year to adapt to the latest OS, campatibility-wise or UI-wise; and release notes, especially with dates, serve as almost the single metric for gauging developer commitment. In fact, whenever I try to learn about a piece of software that I heard about, one of the first things I do, usually after browsing through features and screenshots and before I even download the software to try out, is to look for its release notes and skim through it if available, and the outcome largely determines whether I'll even bother to download the installer.<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-12-the-importance-of-dated-detailed-release-notes.html#fn1" id="fnref1"><sup>1</sup></a> A prominent, dedicated page with dated, detailed release notes immediately leaves a good impression on me.</p>
<p>Unfortunately, many developers or publishers don't value release notes as much as I do. Several problems, in ascending order of seriousness:</p>
<ul>
<li><p>Most release notes are not linked to from the home page or at least the download page, which kind of makes sense when the audience is generally non-technical, but there's little excuse when the software's targeted audience are pro-level or power users. This is not a big problem now because Google is very good at turning up release notes as long as they exist.</p></li>
<li><p>Quite some release notes are not dated, which I can't understand &#8212; it's so easy to date each entry, and it adds so much context, especially for gauging commitment (I guess developers who are less commited might not want to insert dates precisely for this reason).</p></li>
<li><p>For some software, releases notes are downright nonexistent, at least not on the web. Interestingly, occasionally they are available from an in-app menu or distributed document; the publishers just don't bother to put it on a web page. Not surprisingly, I might as well not bother to download this kind of software.<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-12-the-importance-of-dated-detailed-release-notes.html#fn2" id="fnref2"><sup>2</sup></a></p></li>
</ul>
<p>If I were ever to publish closed source software, I'll definitely have dated, detailed release notes, linked to from the home page.</p>
<hr/>
<p>P.S. Speaking of release notes, it's hard not to complain about MAS, as if there are not enough complaints about this horrible platform. You can only view the most recent release with its release notes (and some publishers stack "bug fixes" notes of minor/patch releases on top of the real notes of the last major release, making it ever more confusing), whereas in the iOS App Store you have the "Version History" page that shows you a dated list of releases with release notes &#8212; what I would expect from everywhere. Basically, Apple has all this data and they can show it to you in a satisfactory way it they want to, but they blew it by not bothering to implement it. Note that I'm much more likely to care about the release notes of an OS X application than an iOS app, and I daresay most power users will agree with me.</p>
<p>Of course there are much more serious problems with MAS like the lack of trials, so the release notes problem is nothing but an insult over injury. In short, MAS is not a good distribution channel; it's only a lazy one, a compromise for small publishers.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>Nowadays, with homebrew-cask, I'm much more likely to give things a spin, but still, I take an especially defensive stance against anything that doesn't have release notes.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-12-the-importance-of-dated-detailed-release-notes.html#fnref1">&#8617;&#65038;</a></p></li>
<li id="fn2"><p>Yes, I won't deny that downloaded some of them nevertheless &#8212; that's how I found out.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-12-the-importance-of-dated-detailed-release-notes.html#fnref2">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">Printing long, 80-character-per-line plain text document in two columns</title><link href="http://zmwangx.github.io/blog/2015-10-10-printing-long-80-character-per-line-plain-text-document-in-two-columns.html"/><updated>2015-10-10T22:35:15-07:00</updated><id>http://zmwangx.github.io/blog/2015-10-10-printing-long-80-character-per-line-plain-text-document-in-two-columns.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p><strong>TL; DR</strong>. Jump to <a href="http://zmwangx.github.io/blog/2015-10-10-printing-long-80-character-per-line-plain-text-document-in-two-columns.html#code">code</a>.</p>
<hr/>
<p>Printing is hard. Everyone who has ever tried to set up a printer (especially a multifunction unit) will probably agree with me. There are also a million ways to be sabotaged by your printer, e.g., connection failure (over Wi-Fi), toner running low, manual duplex eating two sheets at once when printing the second side. (Do you believe I encountered all three tonight?) Anyway, let's just assume that you have a perfectly connected, perfectly functional printer, and talk about something even harder.</p>
<p>We nerds read 80-character-per-line (or 72, but it's safer to assume longer) plain text documents all the time, or at least occasionally if we exclude source code. A plain text document is extremely versatile; it looks awesome in a text editor or in a browser window &#8212; with monospace typeface of your choice and infinite scrolling or arbitrary pagination. However, the problem is, sometimes we want to put things into print for easier reference, and we do <em>not</em> have infinite scrolling or arbitrary pagination in print. We want to divide things up into pieces that fit nicely onto 8.5'' by 11'' sheets, without ruining the original formatting of the plain text document. Therefore, some program has to decide the page layout and translate the plain text document into something a printer understands, e.g., PostScript. But since plain text is so versatile, there are a million ways to lay it out on paper.</p>
<p>You would assume that this is a solved problem, since the digital publishing industry has been around for 40 years; and you would assume that this should be easy on a Mac because it is a great platform for "creative professionals". And indeed it's not hard if you just want to print one column of 80 characters. You can even do that in TextEdit, where you pick a plain text font and font size so that lines don't wrap, and there you go. If you are using a more capable GUI text editor like TextWrangler (I use Emacs all the time but I don't know about printing from Emacs), you are given more customization options like header and line numbers. However, 80 character lines look awful on a 8.5'' wide page. Characters are HUGE (to me anyway). Note that monospaced fonts usually look better when they are smaller (I'm a <a href="http://zmwangx.github.io/blog/2015-08-31-after-all-these-years-10pt-non-anti-aliased-monaco-is-still-the-best.html">10pt bitmap Monaco fan</a>), and do keep in mind that we are usually farther away from a computer screen than a piece of paper held in hand, so even "10pt" could look pretty big in print. Moreover, you most likely get the outlined version of your font in print rather than the bitmap version, which depending on your font of choice might not be a good thing, and the difference is amplified when characters are big. And above all, you waste a lot of paper this way, and create stapling problems for yourself when the document is long. In short, I don't find it a good solution.</p>
<p>It would be much nicer if we could print in two columns. The characters will be pretty small so it's probably not very good for older people (or they could try two columns in landscape), but I'm still pretty young and have fairly good eyesight, so I like this idea. But turns out this is nontrivial with existing GUI programs, at least the ones that I know of. You could emulate the two-column layout by having four pages on one sheet, but it's really awkward because you get a page divider in each single column (waste of space), and page numbering would be all messed up. Other than that there's little you could do. I guess there's just not enough market for this particular need. Luckily we have a large selection of modular command line utilities that we can stitch together for great results. I'll cut the bullshit here and just show you the <span id="code">code</span> (for US letter):</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">curl</span> https://www.gnu.org/software/bash/manual/bash.txt \
    <span class="kw">|</span> <span class="kw">pr</span> --columns=2 --width=168 --length=120 --form-feed --date-format=%Y-%m-%d --header=<span class="st">"Bash Reference Manual"</span> - \
    <span class="kw">|</span> <span class="kw">enscript</span> --media=Letter --header= --font=Courier5.5 --margins=18:18:0:18 --output - \
    <span class="kw">|</span> <span class="kw">ps2pdf</span> - bash-print.pdf</code></pre></div>
<p>Here, as an example, I'm printing the ASCII text version of the Bash Reference Manual. <code>pr</code> ships with <code>coreutils</code> (OS X also ships with the BSD version of <code>pr</code>, but geez, I'm a <code>coreutils</code> fan), so if you just <code>brew install coreutils</code> then you should use <code>gpr</code> instead. <code>enscript</code> here is <a href="https://www.gnu.org/software/enscript/">GNU Enscript</a>, which could be installed with <code>brew install enscript</code> (credit to <a href="https://askubuntu.com/questions/27097/">Ask Ubuntu</a> for pointing me to this utility). <code>ps2pdf</code> ships with GhostScript, so you could do <code>brew install gs</code>, but you should already have it if you've got the MacTeX or TeXLive distribution installed. The options I'm using should be pretty self-explanatory and tweakable, but in case you don't understand something, just RTFM (that way you could also find more options). Anyway, a page of <code>bash-print.pdf</code> from the above looks like this (this one happen to be a 72-char-per-line document, whereas my numbers are tailored for 80; the image is at 300 ppi):</p>
<div class="figure">
<a href="http://zmwangx.github.io/img/20151010-bash-print-sample-page.png" target="_blank"><img alt="Sample page from bash-print.pdf generated above. I drew a black, one-pixel border so you could tell the page from the background." src="http://zmwangx.github.io/img/20151010-bash-print-sample-page.png"/></a>
<p class="caption">Sample page from <code>bash-print.pdf</code> generated above. I drew a black, one-pixel border so you could tell the page from the background.</p>
</div>
<p>P.S. Preview.app on El Capitan just caught me by surprise. If memory serves, exporting PDF to PNG in Preview.app used to produce only one image for the current page, but now apparently you get a single, gigantic <a href="https://en.wikipedia.org/wiki/APNG">APNG</a> with each page in a frame. It's not very useful at 10 fps, though. Also, exporting to JPEG doesn't give you an MJPEG.</p>
]]></content></entry><entry><title type="html">We need an OS X security white paper</title><link href="http://zmwangx.github.io/blog/2015-10-03-we-need-an-os-x-security-white-paper.html"/><updated>2015-10-03T03:34:24-07:00</updated><id>http://zmwangx.github.io/blog/2015-10-03-we-need-an-os-x-security-white-paper.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>Apple has been offering an excellent <a href="https://www.apple.com/privacy/docs/iOS_Security_Guide.pdf">iOS Security White Paper</a> since at least 2012, and it's very informative. I highly encourage everyone to read it. It even explains some annoyances of iOS; for instance, <a href="http://www.relay.fm/upgrade/56">this week's Upgrade episode</a> discussed, <a href="https://daringfireball.net/linked/2015/10/01/upgrade-56">in Gruber's words</a>, "the lousy, painstaking, and at times downright confusing experience of migrating to a new iOS device", and once you read the white paper you'll realize that many things just can't be migrated due to iOS's hardware security model &#8212; basically, certain classes of data are encrypted with crypto keys baked into the silicon (see the section "Hardware security features"). I'm not saying the migration experience should be this painful (I would love to see it fixed or improved), but at least there's an explanation.<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-03-we-need-an-os-x-security-white-paper.html#fn1" id="fnref1"><sup>1</sup></a></p>
<p>But I digress. This post is about OS X. I've been hunting for an OS X equivalent for a while now, but I don't think it exists. And recently people are talking about Apple's <a href="https://www.apple.com/privacy/">updated Privacy website</a><a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-03-we-need-an-os-x-security-white-paper.html#fn2" id="fnref2"><sup>2</sup></a>, so I went there with a glimmer of hope. End result: no luck. In fact, Apple links to its iOS Security White Paper at the bottom of "<a href="https://www.apple.com/privacy/approach-to-privacy">Our Approach to Privacy</a>":</p>
<div class="figure">
<a href="http://zmwangx.github.io/img/20151003-ios-security-white-paper-but-no-osx.png" target="_blank"><img alt="iOS Security White Paper linked, but no OS X." src="http://zmwangx.github.io/img/20151003-ios-security-white-paper-but-no-osx.png"/></a>
<p class="caption">iOS Security White Paper linked, but no OS X.</p>
</div>
<p>But there's little to no mention of OS X (the words "Mac" and "OS X" each appears only once on the page). This is not surprising; OS X as the second class citizen is nothing new, and iPhones and Apple Watches are arguably more intimate, and hence more private devices &#8212; at least for most people. It is somewhat disappointing though.</p>
<p>I forgot to mention why I would like to see an OS X security white paper. The reason is simple: a lot of security features are under-explained. For instance, I might want to learn more about FileVault: why am I given the choice of decrypting my drive with iCloud &#8212; I believe it's not the case on iOS? How does iCloud handle my disk encryption key, if I allow it access (I don't)? Or I might want to learn more about System Integrity Protection: does it auto revert (or repair, in their eyes) some permissions (e.g., that of <code>/usr/local</code>), as I heard people talking about? Or maybe more about code signing and the inner workings of Gatekeeper: there's <a href="http://arstechnica.com/security/2015/09/drop-dead-simple-exploit-completely-bypasses-macs-malware-gatekeeper/">recent news</a> of Gatekeeper workarounds. I guess some of these stuff can be found in Apple's support documents or developer documentation if you look hard enough, but it would be nice if the major security features and their implementations are presented coherently in a single document. Maybe the OS X security model is too complex and diverse to fit into a single document? I don't know. Anyway, I'll keep waiting.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>Loss of certain classes of protected data (due to hardward crypto keys) during migration should in principle only apply to migration by "restoration". What about providing a direct phone-to-phone migration, where data could be decrypted and transferred on the fly? But that would at least require a lightning male to lightning male cable (or you would have to entrust your most sensitive data, which shouldn't even leave the phone under normal conditions, to your Wi-Fi, something Apple probably wouldn't do), and having to use a different, and actually unheard-of cable isn't very realistic, so it won't be happening any time soon.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-03-we-need-an-os-x-security-white-paper.html#fnref1">&#8617;&#65038;</a></p></li>
<li id="fn2"><p>I haven't read through everything, but the idea of a <a href="https://www.apple.com/privacy/privacy-policy/">non-law-practicing-human readable privacy policy</a> is great.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-03-we-need-an-os-x-security-white-paper.html#fnref2">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">Auto hidden menu bar &amp; dock + maximized window is the new full screen mode</title><link href="http://zmwangx.github.io/blog/2015-10-01-auto-hidden-menu-bar-dock-maximized-window-is-the-new-full-screen-mode.html"/><updated>2015-10-01T15:48:59-07:00</updated><id>http://zmwangx.github.io/blog/2015-10-01-auto-hidden-menu-bar-dock-maximized-window-is-the-new-full-screen-mode.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>One nice feature of OS X El Capitan is that the menu bar can be auto hidden. Combined an auto hidden dock, we can now emulate the full screen experience with a maximized window while still enjoying overlayed windows, e.g., transparent terminal windows or "Picture in Picture" style small floating player. To see how closely a full screen experience is emulated this way, see the side-by-side screenshots below.</p>
<div class="figure">
<a href="http://zmwangx.github.io/img/20151001-maximized-window-vs-full-screen.png" target="_blank"><img alt="Maximized and full screen windows of Google Chrome side by side. Can you tell any difference apart from the color of the title bar and a bit of black bottom margin on the left?" src="http://zmwangx.github.io/img/20151001-maximized-window-vs-full-screen.png"/></a>
<p class="caption">Maximized and full screen windows of Google Chrome side by side. Can you tell any difference apart from the color of the title bar and a bit of black bottom margin on the left?</p>
</div>
<p>I've always liked maximized windows much better than full screen windows. (Maybe this is part of the legacy from my early Windows days? Anyway, to Microsoft's credit, Windows <em>is</em> better in certain aspects, e.g., File Explorer. You see, I'm still fighting Finder to this day. Window maximization is also something that Windows does better, although I do like OS X's universal menu bar and hate the Windows menus that could appear in all kinds of surprising places.) There are legit reasons to perfer maximized windows over full screen. One obvious advantage is persistent window stacking, which has already been mentioned. Moreover, sometimes I need to temporarily bring up another app for a quick task, which is to say I need something like iOS 9's Slide Over &#8212; but on the desktop slide-over already comes for free with window overlay. In full screen mode, however, the second app will be opened in another desktop space with lavish animation of switching, and when I'm done I need to swipe back to the original space, again with lavish animation, instead of just &#8984;H to hide. Do it several times in quick succession and it's a pretty nauseous experience (of course I'm exaggerating, but it's certainly neither comfortable nor productive).</p>
<p>In short, maximized windows have always been great, and now they are getting even better.</p>
<p>P.S. I personally don't have many informational moving parts in the menu bar. There's date time down to seconds, but I have an Apple Watch on my wrist, and I don't mind raising my wrist for a few seconds when I need the time. There's a battery icon which I certainly won't look at constantly &#8212; my MBP is plugged in most of the time. There's a Dropbox icon that would animate when it is syncing, which I don't care. Other than that, all icons are still. Therefore, I can totally do away with the menu bar until I really need it.</p>
]]></content></entry><entry><title type="html">Upgrading to El Capitan</title><link href="http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html"/><updated>2015-10-01T11:46:44-07:00</updated><id>http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>I upgraded to El Capitan last night, and the experience is pretty painless. To be accurate, I'm not really upgrading in place &#8212; I always perform a clean install for each major OS upgrade to avoid subtle breakage later on. Therefore, what I did instead was to <code>rsync</code> out all my valuable data and state information<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html#fn1" id="fnref1"><sup>1</sup></a> to an external drive, wipe the internal drive clean, install new OS from scratch, then <code>rsync</code> everything back in. <code>rsync</code> is really good at this stuff (I affectionately alias <code>rsync -avP</code> to <code>r</code> during transfers in and out), and it is simply amazing at dropping the right stuff at the right place, including data deep down <code>~/Library/Containers</code>, without interfering with the existing structures<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html#fn2" id="fnref2"><sup>2</sup></a>. With data and state info ready, reinstalling programs is also easy, thanks to my recently finished <a href="http://zmwangx.github.io/blog/2015-08-25-automated-os-x-provisioning.html">automated provisioning system</a>. It was the first time I used it outside a VM to provision an OS from almost scratch, and I'm really happy with it.</p>
<p>Thus far, most of my programs and applications seem to work just fine on El Capitan. I needed to <code>brew reinstall pyenv --HEAD</code> because an OpenSSL fix for El Capitan hasn't made into a release yet. Some of XtraFinder's features<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html#fn3" id="fnref3"><sup>3</sup></a>, including my most needed auto resizing columns, don't seem to work on El Capitan yet, and I'll have to contact the developer soon. The only distratrous incompatibility I've seen lies with Mathematica 9; <code>codesign -vvvv Mathematica.app</code> on the v9.0.1 app bundle says <code>resource envelope is obsolete (version 1 signature)</code>, and OS X downright refused to open the app, offering me no option other than trashing the app, even when I temporarily set Gatekeeper to "Any". Anyway, I quickly paid to upgrade to v10.2.0 (cost of free OS upgrade, geez), and it ran happily afterwards. Those were basically all I had to deal with. I haven't set up my mail accounts<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html#fn4" id="fnref4"><sup>4</sup></a> and printer yet, but hopefully they will work, and just hopefully Apple Mail finally got it right this time&#8482; and won't ask me to reauthenticate with Gmail all the time.</p>
<p>Overall it was pretty good experience. Nevertheless, I was caught by surprise at least twice, due to subtle user-facing changes in the OS. Actually these surprises motivated me to write this post.</p>
<p>First, <u>the OS seems to default to using the iCloud password (i.e., the Apple ID password) as the local account password now.</u> Maybe I missed a checkbox during setup (unlikely), and maybe it was nothing new (I don't think so), but I only realized this when I needed to <code>sudo</code> on the new OS for the first time. I typed my usual local password thrice, no luck. Did I accidentally gave my 1Password master password? Thrice, no luck. Did I accidentally used Vagrant's default password (i.e., <code>vagrant</code>, however unlikely)? This one is short enough and I didn't need to type it thrice to realize it was wrong &#8212; I knew that all along anyway. Did I... No, I couldn't have used anything else (literally ten minutes ago) without remembering it. I was completely horror-struck at that point, but speaking of remembering, I didn't even remember giving a password hint! So could it be... Yes, I typed in my 32 character long iCloud password, and this time it was right. I quickly realized after the fact that this setting could be toggled in the standard System Preferences -&gt; Users &amp; Groups -&gt; Change Password... (see screenshot below), so if you are in this situation, don't panic. I don't like this move though. Hopefully Apple won't degrade to Microsoft's level at some future point, where you either sign in with a Microsoft account (and have to type your Microsoft password to log in) or miss out on cloud features with a local account.</p>
<div class="figure">
<a href="http://zmwangx.github.io/img/20151001-osx-el-capitan-icloud-password-to-log-in.png" target="_blank"><img alt="Screenshot taken after I've changed to a local password. After initial setup, it would be the reverse." src="http://zmwangx.github.io/img/20151001-osx-el-capitan-icloud-password-to-log-in.png"/></a>
<p class="caption">Screenshot taken after I've changed to a local password. After initial setup, it would be the reverse.</p>
</div>
<p>Secondly, <u>three finger drag, a multitouch gesture that I use all the time to move windows on screen, is now mysteriously gone from System Preferences -&gt; Trackpad</u> (it used to be in "Touch &amp; Click"):</p>
<div class="figure">
<a href="http://zmwangx.github.io/img/20151001-osx-el-capitan-wheres-my-three-finger-drag.png" target="_blank"><img alt="Where's my beloved three finger drag? By the way, since it is shown in this screenshot, I'll officially declare here that I'm a tap-to-click wizard." src="http://zmwangx.github.io/img/20151001-osx-el-capitan-wheres-my-three-finger-drag.png"/></a>
<p class="caption">Where's my beloved three finger drag? By the way, since it is shown in this screenshot, I'll officially declare here that I'm a tap-to-click wizard.</p>
</div>
<p>Maybe Apple found it somewhat confusing with the three finger tap/click, which is clearly a different gesture. I found the solution in an Apple Support document, <a href="https://support.apple.com/en-us/HT204609">Turn on "three finger drag" for your Force Touch trackpad</a>, while my trackpad is clearly not Force Touch (the document was written for Yosemite, so clearly the reorganized settings started out on the MacBook One and newer Retina MacBook Pros in Yosemite and spreaded to all Macs in El Capitan). Anyway, the gesture could be turned on in System Preferences -&gt; Accessibility -&gt; Mouse &amp; Trackpad Options... -&gt; Enable dragging. That was godawful, no one could possibly find it, but hopefully it's hidden there because of the confusion rather than Apple intentionally phasing it out.</p>
<div class="figure">
<a href="http://zmwangx.github.io/img/20151001-osx-el-capitan-three-finger-drag-there-it-is.png" target="_blank"><img alt="Oh, there it is!" src="http://zmwangx.github.io/img/20151001-osx-el-capitan-three-finger-drag-there-it-is.png"/></a>
<p class="caption">Oh, there it is!</p>
</div>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>State information includes <code>~/.config</code> and <code>~/.local</code>, Google Chrome and Firefox profiles, Messages archive, Mathematica customizations, Unclutter notes, VMware Fusion inventory, various important plists, and so on and so forth.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html#fnref1">&#8617;&#65038;</a></p></li>
<li id="fn2"><p>Unless you are stupid enough to specify the <code>--delete</code> flag when you transfer in.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html#fnref2">&#8617;&#65038;</a></p></li>
<li id="fn3"><p>As mentioned in <a href="http://zmwangx.github.io/blog/2015-07-30-the-sad-state-of-finder-on-el-capitan.html">The sad state of Finder on El Capitan</a>, I've disabled SIP and am running XtraFinder. I simply can't live with the stock Finder, that is, without code injection.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html#fnref3">&#8617;&#65038;</a></p></li>
<li id="fn4"><p>Setting up mail accounts is the most painful thing in the world, especially if you have a dozen of them for different tasks.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-10-01-upgrading-to-el-capitan.html#fnref4">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">Removing Google Analytics from this blog</title><link href="http://zmwangx.github.io/blog/2015-09-25-removing-google-analytics-from-this-blog.html"/><updated>2015-09-25T12:30:25-07:00</updated><id>http://zmwangx.github.io/blog/2015-09-25-removing-google-analytics-from-this-blog.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>There was a lengthy discussion about Peace and ad-blocking in <a href="http://atp.fm/episodes/136">Accidental Tech Podcast Episode 136</a>. There were many lessons to learn from the story; as a side effect, it also made me reconsider Google Analytics on this blog.</p>
<p>I've been a user of ad-blocking for years and have little to no moral burden.<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-09-25-removing-google-analytics-from-this-blog.html#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-09-25-removing-google-analytics-from-this-blog.html#fn2" id="fnref2"><sup>2</sup></a> I do hate being tracked online, even by Google (to whom I entrust so much of my personal information), although it's certainly better (I believe) than the host of shadier ad networks out there. Given this, why should I force something even I hate down my visitors' throats? Google Analytics is nice at telling me how many page views I got and where they came from, and I don't earn any money from it so I shouldn't feel guilty, but (1) it does install a tracker, and (2) I care very little about traffic anyway.</p>
<p>At this point the decision is pretty clear. I'm simply removing Google Analytics from this blog. This makes the blog entirely cookie-free and JS-free (except for the very occasional JS embed).</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>I do try to support websites I frequent, e.g., through <a href="https://arstechnica.com/subscriptions/">Ars Premier</a>.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-09-25-removing-google-analytics-from-this-blog.html#fnref1">&#8617;&#65038;</a></p></li>
<li id="fn2"><p>Although it's easy to be a user of ad-blocking, I fully understand the moral (or even legal) burden of being the developer of an ad-blocker, let alone being the "face" of the ad-blocking industry; therefore, I understand and respect Marco's decision of pulling Peace.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-09-25-removing-google-analytics-from-this-blog.html#fnref2">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">Apple Watch: Digital Crown tightness issue</title><link href="http://zmwangx.github.io/blog/2015-09-24-apple-watch-digital-crown-tightness-issue.html"/><updated>2015-09-24T10:55:38-07:00</updated><id>http://zmwangx.github.io/blog/2015-09-24-apple-watch-digital-crown-tightness-issue.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>Quick tip: if the Digital Crown on your Apple Watch <em>all of a sudden</em><a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-09-24-apple-watch-digital-crown-tightness-issue.html#fn1" id="fnref1"><sup>1</sup></a> feels too tight and doesn't turn smoothly, probably it was somehow over-turned (and probably because you played with watchOS 2 Time Travel, as I did). I don't know how that happened because it's clearly not supposed to happen, but turning it in the easy-to-turn direction for a few rounds fixed the tightness issue for me.</p>
<p>There's also an <a href="https://support.apple.com/en-us/HT204639">Apple Support document</a> on troubleshooting and cleaning the Digital Crown, if the above doesn't help.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>Especially after upgrading to watchOS 2. Why in the hell could upgrading the software screw up the hardware? You'll see a possible cause if you read on.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-09-24-apple-watch-digital-crown-tightness-issue.html#fnref1">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">Zsh 5.1 and bracketed paste</title><link href="http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html"/><updated>2015-09-21T14:40:36-07:00</updated><id>http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p><strong>TL;DR.</strong> Jump to <a href="http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html#code">code</a>.</p>
<hr/>
<p>In short, Zsh 5.1 introduced bracketed paste mode<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html#fn1" id="fnref1"><sup>1</sup></a> and turned it on by default (as it seems to me<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html#fn2" id="fnref2"><sup>2</sup></a>). It is nice in certain ways &#8212; I appreciate the change, yet I was bitten nevertheless. In at least two ways:</p>
<ol style="list-style-type: decimal">
<li><p>Most annoyingly, <code>url-quote-magic</code> doesn't work anymore when pasting URLs, so for example if I paste</p>
<pre><code>https://www.google.com/search?q=zsh</code></pre>
<p>without typing in a single or double quote first, the <code>?</code> and <code>=</code> won't be backslash-quoted by default, which causes an error when passed unnoticed (out of habit).</p></li>
<li><p>The Emacs shell<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html#fn3" id="fnref3"><sup>3</sup></a> is littered with <code>^[[?2004h</code> and <code>^[[?2004l</code> around every prompt.</p></li>
</ol>
<p>The solution? Zsh now also ships with <a href="https://github.com/zsh-users/zsh/blob/master/Functions/Zle/bracketed-paste-magic"><code>bracketed-paste-magic</code></a> that resolves exactly breakage #1 (and a bit more); to quote comments from the linked source file:</p>
<blockquote>
<p>Starting with zsh-5.1, ZLE began to recognize the "bracketed paste" capability of terminal emulators, that is, the sequences <code>$'\e[200~'</code> to start a paste and <code>$'\e[201~'</code> to indicate the end of the pasted text. Pastes are handled by the bracketed-paste widget and insert literally into the editor buffer rather than being interpreted as keystrokes.</p>
<p>This disables some common usages where the self-insert widget has been replaced in order to accomplish some extra processing. An example is the contributed url-quote-magic widget. The bracketed-paste-magic widget replaces bracketed-paste with a wrapper that re-enables these self-insert actions, and other actions as selected by the zstyles described below.</p>
</blockquote>
<p>And to resolve breakage #2, just disable bracketed paste altogether for dumb terms.</p>
<p id="code">
Putting it together:
</p>
<div class="sourceCode"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span class="co"># turn off ZLE bracketed paste in dumb term</span>
<span class="co"># otherwise turn on ZLE bracketed-paste-magic</span>
<span class="kw">if [[</span> <span class="ot">$TERM</span> <span class="ot">==</span> dumb<span class="kw"> ]]</span>; <span class="kw">then</span>
    <span class="kw">unset</span> zle_bracketed_paste
<span class="kw">else</span>
    <span class="kw">autoload</span> -Uz bracketed-paste-magic
    <span class="kw">zle</span> -N bracketed-paste bracketed-paste-magic
<span class="kw">fi</span></code></pre></div>
<hr/>
<p><span id="update"><strong>09/22/2015 update.</strong></span> I only read <code>NEWS</code> and not <code>README</code>, so I missed out on a very clear announcement of the <a href="https://github.com/zsh-users/zsh/blob/68405f31a043bdd5bf338eb06688ed3e1f740937/README#L38-L45">bracketed paste incompatibitilies (between 5.0.8 and 5.1)</a>:</p>
<blockquote>
<p>The default behaviour when text is pasted into an X Windows terminal has changed significantly (unless you are using a very old terminal emulator that doesn't support this mode). Now, the new "bracketed paste mode" treats all the pasted text as literal characters. This means, in particular, that a newline is simply inserted as a visible newline; you need to hit Return on the keyboard to execute the pasted text in one go. See the description of <code>zle_bracketed_paste</code> in the <code>zshparams</code> manual for more. "<code>unset zle_bracketed_paste</code>" restores the previous behaviour.</p>
</blockquote>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>Bracketed paste mode is a safeguard against inadvertent interpretation of pasted text, e.g., newline being treated at <code>accept-line</code> in Zsh. You may read more about it <a href="https://cirw.in/blog/bracketed-paste">in this blog post</a>, which is somewhat outdated yet still informational.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html#fnref1">&#8617;&#65038;</a></p></li>
<li id="fn2"><p>Indeed it is. See <a href="http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html#update">update</a> with more accurate info from official source.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html#fnref2">&#8617;&#65038;</a></p></li>
<li id="fn3"><p>I seldom use this dumb (literally) thing, but when I do I expect it to work ungarbled, naturally.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-09-21-zsh-51-and-bracketed-paste.html#fnref3">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">After all these years, 10pt non-anti-aliased Monaco is still the best</title><link href="http://zmwangx.github.io/blog/2015-08-31-after-all-these-years-10pt-non-anti-aliased-monaco-is-still-the-best.html"/><updated>2015-08-31T06:31:03+08:00</updated><id>http://zmwangx.github.io/blog/2015-08-31-after-all-these-years-10pt-non-anti-aliased-monaco-is-still-the-best.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>Ars Technica <a href="http://arstechnica.com/information-technology/2015/08/open-source-typeface-hack-brings-design-to-source-code/">just ran a piece</a> on the open source programming font <a href="https://github.com/chrissimpkins/Hack">Hack</a>. Now I don't really know why this is news-worthy (open source programming fonts aren't a new thing), but I thought I'd give it a try.</p>
<p>The result is unsurprising. I've loved my 10pt non-anti-aliased Monaco for years, beginning with the Pro profile of Terminal.app. In fact, I initially refused to use iTerm2 precisely because I can't reproduce my beloved typeface in it, until I found out the non anti-aliasing trick. This time again, Hack simply can't compete with my favorite font; see the screenshots below. Among other things, it is way too thick for my liking &#8212; the same problem that haunts a whole range of programming fonts. Note that Hack is <a href="https://github.com/chrissimpkins/Hack#about">supposed to</a> look good at 8px&#8211;12px according to its README, but I tested it at 9pt&#8211;12pt in iTerm2 (I know, pt is supposed to be larger than px, but I seriously doubt that anyone would want 8px or 6pt as their daily font size &#8212; and for that matter iTerm2 doesn't even allow me to go below 9pt, a pretty reasonable restriction, I'd say).</p>
<p>By the way, it is worth pointing out that the very same Monaco looks horrible at 9pt or 11pt, anti-aliased or not (same goes for 10pt anti-aliased). 10pt non-anti-aliased Monaco is simply a miracle.</p>
<p><strong>09/01/2015 update:</strong> Looks like I was quite confused about pt and px, and they are to be used interchangeably in the current context. I suggest that anyone interested in this subject also read John Gruber's two very informative pieces from 2003, <a href="http://daringfireball.net/2003/03/antialiasing.html"><em>Anti-Aliasing</em></a> and <a href="https://daringfireball.net/2003/03/anti-anti-aliasing"><em>Anti-Anti-Aliasing</em></a>.</p>
<div class="figure">
<a href="http://zmwangx.github.io/img/20150831-terminal-app-pro-profile.png" target="_blank"><img alt="Pro profile in Apple's Terminal.app, with 10pt non-anti-aliased Monaco. That says something about the font's quality, especially on a dark background." src="http://zmwangx.github.io/img/20150831-terminal-app-pro-profile.png"/></a>
<p class="caption">Pro profile in Apple's Terminal.app, with 10pt non-anti-aliased Monaco. That says something about the font's quality, especially on a dark background.</p>
</div>
<div class="figure">
<a href="http://zmwangx.github.io/img/20150831-monaco-10pt-non-antialiased.png" target="_blank"><img alt="10pt non-anti-aliased Monaco is life." src="http://zmwangx.github.io/img/20150831-monaco-10pt-non-antialiased.png"/></a>
<p class="caption">10pt non-anti-aliased Monaco is life.</p>
</div>
<div class="figure">
<a href="http://zmwangx.github.io/img/20150831-hack-8,9,10,11pt-antialiased-combined.png" target="_blank"><img alt="Hack, anti-aliased, at 9pt, 10pt, 11pt and 12pt, respectively. Click to enlarge." src="http://zmwangx.github.io/img/20150831-hack-8,9,10,11pt-antialiased-combined.png"/></a>
<p class="caption">Hack, anti-aliased, at 9pt, 10pt, 11pt and 12pt, respectively. Click to enlarge.</p>
</div>
]]></content></entry><entry><title type="html">Automated OS X provisioning</title><link href="http://zmwangx.github.io/blog/2015-08-25-automated-os-x-provisioning.html"/><updated>2015-08-25T08:16:44-07:00</updated><id>http://zmwangx.github.io/blog/2015-08-25-automated-os-x-provisioning.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>After quite a bit of work, I finally have a decent OS X provisioning system, capable of provisioning a blank OS X install (with Xcode and CLT) for development and everyday life.</p>
<p>Here it is: <a href="https://github.com/zmwangx/dotfiles/blob/master/provision"><code>zmwangx/dotfiles/provision</code></a>. In case the path changes in the future and invalidates the aforementioned URL, <a href="https://github.com/zmwangx/dotfiles/blob/d8e20b731583d69b380d422c8788f61cd4a4e211/provision">here</a> is the archived provisioning script at the current master. Of course the provisioning system is not a single script; it reads and executes modules from a <a href="https://github.com/zmwangx/dotfiles/tree/master/provision.d"><code>provision.d</code></a> directory, which in turn links into other specialized parts of the system.</p>
<p>Selling points:</p>
<ul>
<li><p>Highly modular due to the <code>provision.d</code> structure. New provisioning scripts for specialized tools can be added at any time without complicating the rest of the system.</p></li>
<li><p>Graceful failure and easy error recovery. For most failures, running the provision once more fixes the issues. This is especially helpful when GitHub get DDoS'ed and loads of downloads fail, e.g., <a href="https://web.archive.org/web/20150825150044/https://status.github.com/messages">last night</a>, when I was sleeping with the provisioning system hard at work.</p></li>
<li><p>Very nice, colored console messages. Of course you'd expect that when half of the code is devoted to messaging...</p></li>
</ul>
<p>Thus far tested on OS X 10.10 and 10.11. Works pretty well. Of course OS X provisioning (with so many impossible-to-automate tasks) is still a hell lot harder than Linux provisioning, but hopefully this system will safe me a considerable amount of time and trouble during my at-least-twice-a-year clean OS installation and beta testing in VMs.</p>
<div class="figure">
<a href="http://zmwangx.github.io/img/20150825-osx-provisioning-system.png" target="_blank"><img alt="provision at work. Provisioning a blank machine is probably the only time I need Terminal.app." src="http://zmwangx.github.io/img/20150825-osx-provisioning-system.png"/></a>
<p class="caption"><code>provision</code> at work. Provisioning a blank machine is probably the only time I need Terminal.app.</p>
</div>
]]></content></entry><entry><title type="html">I installed BlockParty, and the only thing I can say is WOW</title><link href="http://zmwangx.github.io/blog/2015-08-20-i-installed-blockparty-and-the-only-thing-i-can-say-is-wow.html"/><updated>2015-08-20T20:58:55-07:00</updated><id>http://zmwangx.github.io/blog/2015-08-20-i-installed-blockparty-and-the-only-thing-i-can-say-is-wow.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p><strong>09/18/2015 update.</strong> Okay, <a href="http://www.marco.org/2015/09/18/just-doesnt-feel-good">Peace has been pulled</a>. Guess I'll keep using it for a while, though.</p>
<hr/>
<p><strong>09/17/2015 update.</strong> I'm now running <a href="http://www.marco.org/2015/09/16/peace-content-blocker">Marco Arment's</a> <a href="https://itunes.apple.com/us/app/peace-block-ads-trackers-powered/id1031035630?mt=8">Peace</a>, powered by Ghostery.</p>
<hr/>
<p>I just let out <a href="http://zmwangx.github.io/blog/2015-08-20-ios-9-turn-off-wi-fi-assist.html">a load of complaints about iOS 9 beta</a> last night, but apparently forgot about one nice thing: <a href="https://developer.apple.com/videos/wwdc/2015/?id=511">Safari content blocking</a>.</p>
<p>In this day and age, not being iOS/OS X developers ourselves won't stop the rest of us from obtaining ObjC/Swift source code.<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-08-20-i-installed-blockparty-and-the-only-thing-i-can-say-is-wow.html#fn1" id="fnref1"><sup>1</sup></a> I simply typed "Safari content blocker" into GitHub's search box, and there it popped, the most starred repo relevant to my search, <a href="https://github.com/krishkumar/BlockParty">krishkumar/BlockParty</a>. Thanks to Apple's new sideloading policy in Xcode 7, I was able to immediately test it out on my phone.</p>
<p>The effect is just amazing. In my few minutes of browsing, I did not seem to encounter a single ad (on various consistently ad-laden news sites). You should definitely give it a shot. What's even more amazing is that BlockParty's <a href="https://github.com/krishkumar/BlockParty/blob/master/RediffBlock/blockerList.json"><code>blockList.json</code></a>, at the time of writing, is only 1578 lines long &#8212; a JSON array with 197 objects. <strong>Only 197 rules, blocking 197 domains.</strong> Compare that to <a href="https://easylist-downloads.adblockplus.org/easylist.txt">EasyList</a>, which at the moment is a <strong>48820 line monster</strong>. Of course, EasyList is much more fine-grained (<a href="https://adblockplus.org/blog/content-blocking-in-safari-9-and-ios-9-good-news-or-the-death-knell-of-ad-blocking-on-safari">as are AdBlockPlus's filtering mechanisms</a>); with BlockParty I can actually see some blank boxes that used to host ads. But still, very impressive. Many thanks to <a href="https://github.com/krishkumar">@krishkumar</a> for publishing BlockParty, and to <a href="https://medium.com/@searls/installing-a-content-blocker-on-ios-9-public-beta-a25b2b83848f">Justin Searls</a> for publishing a detailed tutorial.<a class="footnoteRef" href="http://zmwangx.github.io/blog/2015-08-20-i-installed-blockparty-and-the-only-thing-i-can-say-is-wow.html#fn2" id="fnref2"><sup>2</sup></a></p>
<p>197 domains made our online lives so miserable. Hmm.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>Actually developing a Safari content blocker extension is as easy as writing a JSON blocker list, but I'm not sure if you need an app with a UI to support the extension. Anyway, there are professional iOS developers out there ready to share the code, so I'll just happily join for a ride.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-08-20-i-installed-blockparty-and-the-only-thing-i-can-say-is-wow.html#fnref1">&#8617;&#65038;</a></p></li>
<li id="fn2"><p>Without which I would have been scratching my head, not knowing that I had to go to Settings-&gt;General-&gt;Profiles to trust my personal profile.<a class="footnotes-backlink" href="http://zmwangx.github.io/blog/2015-08-20-i-installed-blockparty-and-the-only-thing-i-can-say-is-wow.html#fnref2">&#8617;&#65038;</a></p></li>
</ol>
</div>
]]></content></entry><entry><title type="html">iOS 9: turn off Wi-Fi Assist!</title><link href="http://zmwangx.github.io/blog/2015-08-20-ios-9-turn-off-wi-fi-assist.html"/><updated>2015-08-20T01:01:57-07:00</updated><id>http://zmwangx.github.io/blog/2015-08-20-ios-9-turn-off-wi-fi-assist.html</id><author><name>Zhiming Wang</name><uri>http://zmwangx.github.io/</uri><email>zmwangx@gmail.com</email></author><content type="html"><![CDATA[

<p>Seriously. Go to Settings-&gt;Cellular, and scroll all the way down to reveal the "Wi-Fi Assist" switch. See screenshot at the end of the post. You'll see a description:</p>
<blockquote>
<p>Automatically use cellular data when Wi-Fi connectivity is poor.</p>
</blockquote>
<p>Switch that off, if you occasionally have shitty Wi-Fi (that kinda works anyway) and at all care about your cellular data usage.</p>
<p>I'll tell my horror story now. Background info: I have unlimited voice and text plus 300 MB data per month, since I've got Wi-Fi almost everywhere I go. Granted, school Wi-Fi (especially dorm) is shitty and drops all the time, but I'm not a streaming-music-on-mobile person, so the Wi-Fi is mostly fine for checking emails, browsing the Web (yes, even <a href="http://murphyapps.co/blog/2015/6/24/an-hour-with-safari-content-blocker-in-ios-9">iMore</a> or <a href="http://blog.lmorchard.com/2015/07/22/the-verge-web-sucks/">The Verge</a> kind of Web), getting push notifications, or even downloading a few podcasts on the go. I usually end up using less than 200 MB of cellular data per month.</p>
<p>However, at the beginning of August (on iOS 9 Public Beta 2 at that time), I somehow managed to burn through 200 MB in four or five days, with consistent daily stats, <em>while I did nothing special, at least not actively</em>. The timing overlaps with when I got my Apple Watch; I don't know if that's a coincidence. Anyway, more than 90% of that usage was under System Services-&gt;Documents &amp; Sync, which I could do nothing about. I had to turn off cellular data until almost the end of my billing cycle, when I stumbled upon the "Wi-Fi Assist" setting. Since then, I only used 4.8 MB &#8212; with 1.5 MB for System Services &#8212; in four days. Hardly a coincidence, I'd say.</p>
<p>In fact, I was pretty delighted when I heard about the ability to auto fallback to LTE when one's on the fringe of Wi-Fi in <a href="https://developer.apple.com/videos/wwdc/2015/?id=719">WWDC '15 Session 719</a> ("Your App and the Next Generation Networks"). However, without another likely suspect, I guess what happened in reality was that when I was sitting in the center of a shitty Wi-Fi, with the system trying to do some background job involving a network connection, it just kept trying to connect via LTE, which probably beat the shitty Wi-Fi consistently. It would be nice if one day our phones would be aware of our data plans (realize that not every one is on a $100/mo 15 GB plan) and throttle its usage wisely.</p>
<p>Anyway, I simply can't understand why the "Wi-Fi Assist" switch, a general system-wide option, appears at the end of Cellular settings, after all the per-app nickel-and-dime settings and statistics. It's nearly impossible to find. Generic settings should be at the top, period.</p>
<p>By the way, I have a lot of gripes about iOS 9 Beta. Maybe I shouldn't whine about beta software &#8212; I never used another iOS beta before so maybe they were even worse &#8212; but I can't help it because this was supposed to be a stability release. Several things immediately jumped to my mind (all present in the latest Public Beta 3), without even trying:</p>
<ul>
<li><p><a href="http://zmwangx.github.io/blog/2015-06-26-ios-9-searchable-settings.html">Searchable settings</a> is a scam. Many items can't be found. For instance, good luck searching for "Wi-Fi Assist". I wonder if the search index is hand-crafted. Also, you can't pull down to search from any screen; you have to go back, back, back, back to the main settings screen, and even then it begins with your last search, even if you're done with it. Ewww.</p></li>
<li><p>Scrolling and switching screens feels janky (system-wide) even on iPhone 6 Plus, supposedly a powerhouse.</p></li>
<li><p>The Music app is indeed totally screwed up (this actually dates back to iOS 8.4). It's so much harder than previous versions.</p>
<p>Dude, give me my old UI with selectable categories on the bottom bar if I've turned off Apple Music, okay? Do I have to put up with the Radio and Connect tabs, completely useless for me? Switching categories &#8212; by which I mean artists, albums, songs genres, etc. &#8212; is infinitely harder now, because you have to scroll all the way up to the top of a category in order to reveal the category selector, which has a dropdown arrow outside but isn't really a dropdown.</p>
<p>And may I go straight to the artwork and playback control screen when I tap to play a song? Damn, when I select and play a song of course I want see the song front and center; don't treat me like an indecisive guy.</p>
<p>And may I kindly request that the artwork does not protrude to the status bar &#8212; you do realize some artworks have white or light backgrounds, rendering the status bar unreadable?</p>
<p>Recently I also noticed that all my old iTunes purchases are showing up and screwing my library. There used to be a switch in System Preferences, the right place for this kind of settings on iOS, but it's since be removed in favor of Apple Music stuff (not sure why they are mutually exclusive), and strangely put in the category switcher. Hell, this abomination is even documented in <a href="https://support.apple.com/en-us/HT204951">"Using the new Music app"</a>; here's <a href="https://i.imgur.com/RJKLqPo.jpg">Apple's official screenshot</a> showing off the stupid category switcher. For me without Apple Music, the switch says "Show iTunes Purchases" instead of "Show Music Available Offline". Pretty clear, huh, not bad. But don't bother, it does absolutely nothing for me.</p></li>
</ul>
<p>I could go on and on and on, but I don't want to waste more time on this crap. The gist is that I'm not impressed by iOS 9 at all at the moment (oh, one thing positive: San Francisco is nice). Hopefully the final release would be in much better shape; but I don't see any hope for the Music mess &#8212; it's not likely to be cleaned up any time soon. I mourn for the old Music app, which is likely gone forever.</p>
<div class="figure">
<a href="http://zmwangx.github.io/img/20150819-ios9-wifi-assist.png" target="_blank"><img alt='The "Wi-Fi Assist" switch, hidden below per-app settings.' src="http://zmwangx.github.io/img/20150819-ios9-wifi-assist.png"/></a>
<p class="caption">The "Wi-Fi Assist" switch, hidden below per-app settings.</p>
</div>
]]></content></entry></feed>
